if(!window.qxsettings)qxsettings={};if(qxsettings["qx.version"]==undefined)qxsettings["qx.version"]="0.0";if(qxsettings["qx.isSource"]==undefined)qxsettings["qx.isSource"]=false;if(!window.qxvariants)qxvariants={};qx.Class.define("packages.com.makeabyte.vhf.ldapbrowser.ui.properties.Zone",{extend:vhf.Main,properties:{WireFrame:{init:vhf.Main.getInstance()},ZonePropWin:{},ZoneObj:{},Callback:{}},construct:function(obj){this.setZoneObj(obj[0]);this.setCallback(obj[1]);this.main();},members:{main:function(){this.setZonePropWin(new qx.ui.window.Window("Zone Properties","icon/16/"+this.getWireFrame().getAppIcon()));this.getZonePropWin().set({showMinimize:true,allowMinimize:false,allowMaximize:true});this.getZonePropWin().setSpace(200,400,0,450);this.getWireFrame()._addToWorkspace(this.getZonePropWin());this.getZonePropWin().removeAll();var ico1=new qx.ui.basic.Atom("Configure each of the zone SOA record properties below.","icon/32/places/network-server.png");with(ico1){setTop(5);setLeft(5);setIconPosition("left");}var tv1=new qx.ui.pageview.tabview.TabView;tv1.set({left:4,top:40,right:4,bottom:50});var t1=new qx.ui.pageview.tabview.Button("General","icon/16/mimetypes/text-ascii.png");t1.setChecked(true);tv1.getBar().add(t1);var p1=new qx.ui.pageview.tabview.Page(t1);tv1.getPane().add(p1);var cl1=new qx.ui.layout.CanvasLayout;cl1.setTop(0);cl1.setLeft(0);cl1.setWidth("100%");cl1.setHeight("100%");cl1.setBackgroundColor("white");cl1.setPaddingLeft(0);p1.add(cl1);var lblName=new qx.ui.basic.Atom("Zone");lblName.setHorizontalChildrenAlign("right");lblName.set({top:30,left:10});var txtName=new qx.ui.form.TextField();txtName.set({top:30,right:30,width:'60%',value:this.getZoneObj().associateddomain[0]});txtName.setReadOnly(true);var txtTip1="This is the name of the zone.<br><b>Example: </b>vhf.local";var tipIcon1=new qx.ui.basic.Atom("","icon/16/apps/accessories-tip.png");tipIcon1.set({top:30,right:10});var tooltipBtn1=new qx.ui.basic.Atom(txtTip1);var tt1=new qx.ui.popup.ToolTip(txtTip1);tipIcon1.setToolTip(tt1);var lblSerial=new qx.ui.basic.Atom("Serial");lblSerial.setHorizontalChildrenAlign("right");lblSerial.set({top:55,left:10});var txtSerial=new qx.ui.form.Spinner(0,0,1000000000000000);txtSerial.set({top:55,right:30,width:'60%',value:(this.getZoneObj().soarecord==undefined)?"":this.getZoneObj().soarecord[0].split(" ")[2]});var txtTip2="The serial number for this DNS zone.<br><b>Example: </b>200142101";var tipIcon2=new qx.ui.basic.Atom("","icon/16/apps/accessories-tip.png");tipIcon2.set({top:55,right:10});var tooltipBtn2=new qx.ui.basic.Atom(txtTip2);var tt2=new qx.ui.popup.ToolTip(txtTip2);tipIcon2.setToolTip(tt2);var lblNameserver=new qx.ui.basic.Atom("Primary Server");lblNameserver.setHorizontalChildrenAlign("right");lblNameserver.set({top:80,left:10});var txtNameserver=new qx.ui.form.TextField();txtNameserver.set({top:80,right:30,width:'60%',value:(this.getZoneObj().soarecord==undefined)?"":this.getZoneObj().soarecord[0].split(" ")[0]});var txtTip3="The primary name server for this zone.<br><b>Example: </b>ns.vhf.local";var tipIcon3=new qx.ui.basic.Atom("","icon/16/apps/accessories-tip.png");tipIcon3.set({top:80,right:10});var tooltipBtn3=new qx.ui.basic.Atom(txtTip3);var tt3=new qx.ui.popup.ToolTip(txtTip3);tipIcon3.setToolTip(tt3);var lblResponsible=new qx.ui.basic.Atom("Responsible Email");lblResponsible.setHorizontalChildrenAlign("right");lblResponsible.set({top:105,left:10});var txtResponsible=new qx.ui.form.TextField();txtResponsible.set({top:105,right:30,width:'60%',value:(this.getZoneObj().soarecord==undefined)?"":this.getZoneObj().soarecord[0].split(" ")[1]});var txtTip4="The email address of the person responsible for this domain.<br><b>Example: </b>hostmaster@vhf.local";var tipIcon4=new qx.ui.basic.Atom("","icon/16/apps/accessories-tip.png");tipIcon4.set({top:105,right:10});var tooltipBtn4=new qx.ui.basic.Atom(txtTip4);var tt4=new qx.ui.popup.ToolTip(txtTip4);tipIcon4.setToolTip(tt4);var lblRefresh=new qx.ui.basic.Atom("Refresh");lblRefresh.setHorizontalChildrenAlign("right");lblRefresh.set({top:130,left:10});var txtRefresh=new qx.ui.form.Spinner(0,0,1000000000000000);txtRefresh.set({top:130,right:30,width:'60%',value:(this.getZoneObj().soarecord==undefined)?"":this.getZoneObj().soarecord[0].split(" ")[3]});var txtTip5="The interval a slave server uses to update its zone data.<br><b>Example: </b>1800";var tipIcon5=new qx.ui.basic.Atom("","icon/16/apps/accessories-tip.png");tipIcon5.set({top:130,right:10});var tooltipBtn5=new qx.ui.basic.Atom(txtTip5);var tt5=new qx.ui.popup.ToolTip(txtTip5);tipIcon5.setToolTip(tt5);var lblRetry=new qx.ui.basic.Atom("Retry");lblRetry.setHorizontalChildrenAlign("right");lblRetry.set({top:155,left:10});var txtRetry=new qx.ui.form.Spinner(0,0,1000000000000000);txtRetry.set({top:155,right:30,width:'60%',value:(this.getZoneObj().soarecord==undefined)?"":this.getZoneObj().soarecord[0].split(" ")[4]});var txtTip6="The interval which the slave server will wait if a zone transfer fails before requesting another transfer.<br><b>Example: </b>3600";var tipIcon6=new qx.ui.basic.Atom("","icon/16/apps/accessories-tip.png");tipIcon6.set({top:155,right:10});var tooltipBtn6=new qx.ui.basic.Atom(txtTip6);var tt6=new qx.ui.popup.ToolTip(txtTip6);tipIcon6.setToolTip(tt6);var lblExpire=new qx.ui.basic.Atom("Expire");lblExpire.setHorizontalChildrenAlign("right");lblExpire.set({top:180,left:10});var txtExpire=new qx.ui.form.Spinner(0,0,1000000000000000);txtExpire.set({top:180,right:30,width:'60%',value:(this.getZoneObj().soarecord==undefined)?"":this.getZoneObj().soarecord[0].split(" ")[5]});var txtTip7="The amount of time before a name server considers its zone data stale.<br><b>Example: </b>86400";var tipIcon7=new qx.ui.basic.Atom("","icon/16/apps/accessories-tip.png");tipIcon7.set({top:180,right:10});var tooltipBtn7=new qx.ui.basic.Atom(txtTip7);var tt7=new qx.ui.popup.ToolTip(txtTip7);tipIcon7.setToolTip(tt7);var lblTTL=new qx.ui.basic.Atom("Time To Live");lblTTL.setHorizontalChildrenAlign("right");lblTTL.set({top:205,left:10});var txtTTL=new qx.ui.form.Spinner(0,0,1000000000000000);txtTTL.set({top:205,right:30,width:'60%',value:(this.getZoneObj().soarecord==undefined)?"":this.getZoneObj().soarecord[0].split(" ")[6]});var txtTip8="The interval which the record is cached on other name servers on the internet.<br><b>Example: </b>7200";var tipIcon8=new qx.ui.basic.Atom("","icon/16/apps/accessories-tip.png");tipIcon8.set({top:205,right:10});var tooltipBtn8=new qx.ui.basic.Atom(txtTip8);var tt8=new qx.ui.popup.ToolTip(txtTip8);tipIcon8.setToolTip(tt8);var btnOK=new qx.ui.form.Button("OK","icon/16/actions/dialog-ok.png");btnOK.set({bottom:10,right:10});btnOK.addEventListener("execute",function(e){this.getWireFrame()._setStatusText("Updating zone...");var json='['+'{ "name" : "dn", "dn" : "'+this.getZoneObj().dn+'" },'+'{ "name" : "SOARecord", "SOARecord" : "'+txtNameserver.getValue()+' '+txtResponsible.getValue()+' '+txtSerial.getValue()+' '+txtRefresh.getValue()+' '+txtRetry.getValue()+' '+txtExpire.getValue()+' '+txtTTL.getValue()+'" }'+']';var callback=qx.lang.Function.bind(this.__updateAttributeHandler,this);this.getWireFrame()._callAsyncRpc(callback,"core.rpc.API","invoke","DNS","updateZone",json);this.getZonePropWin().close();},this);cl1.add(lblName,txtName,tipIcon1);cl1.add(lblSerial,txtSerial,tipIcon2);cl1.add(lblNameserver,txtNameserver,tipIcon3);cl1.add(lblResponsible,txtResponsible,tipIcon4);cl1.add(lblRefresh,txtRefresh,tipIcon5);cl1.add(lblRetry,txtRetry,tipIcon6);cl1.add(lblExpire,txtExpire,tipIcon7);cl1.add(lblTTL,txtTTL,tipIcon8);this.getZonePropWin().add(ico1,tv1,btnOK);var lblCopyright=new qx.ui.basic.Label(this.getWireFrame().getCopyright());lblCopyright.set({bottom:15,left:10});this.getZonePropWin().add(lblCopyright);this.getZonePropWin().open();},__updateAttributeHandler:function(result,ex,id){if(ex!=null){this.getWireFrame()._showAlertDialog("error",""+ex,"RPC Error");this.getWireFrame()._setStatusText("RPC Error!");}if(result){this.getZonePropWin().close();this.getWireFrame()._setStatusText("Ready");var parentDn=this.getZoneObj().dn.replace("dc="+this.getZoneObj().dc[0]+",","");this.getCallback()(parentDn);}},terminate:function(){this.base(arguments);}}});
