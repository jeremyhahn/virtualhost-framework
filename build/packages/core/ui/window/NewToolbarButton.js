if(!window.qxsettings)qxsettings={};if(qxsettings["qx.version"]==undefined)qxsettings["qx.version"]="0.0";if(qxsettings["qx.isSource"]==undefined)qxsettings["qx.isSource"]=false;if(!window.qxvariants)qxvariants={};qx.Class.define("packages.core.ui.window.NewToolbarButton",{extend:vhf.Main,properties:{WireFrame:{init:vhf.Main.getInstance()},NewButtonWin:{init:new qx.ui.window.Window("New Toolbar Button","icon/16/actions/edit-add.png")},BtnName:{init:null},BtnUrl:{init:null},Lv:{init:null},Ld:{init:null}},construct:function(args){this.setLv(args[0]);this.setLd(args[1]);this.main();},members:{main:function(){this.getNewButtonWin().set({showMinimize:true,allowMinimize:false,allowMaximize:true});this.getNewButtonWin().setSpace(200,400,150,200);this.getWireFrame()._addToWorkspace(this.getNewButtonWin());var at1=new qx.ui.basic.Atom("Add New Toolbar Button","icon/22/actions/edit-add.png");at1.setLocation(4,4);var txtNameLabel=new qx.ui.basic.Atom('Name');txtNameLabel.setHorizontalChildrenAlign('right');txtNameLabel.set({top:60,left:30,width:'10%'});var txtName=new qx.ui.form.TextField();txtName.set({top:60,right:30,width:'70%'});var txtTip="The name to display on the toolbar button.";var tipIcon=new qx.ui.basic.Atom("","icon/16/apps/accessories-tip.png");tipIcon.set({top:60,right:10});var tooltipBtn=new qx.ui.basic.Atom(txtTip);var tt1=new qx.ui.popup.ToolTip(txtTip);tipIcon.setToolTip(tt1);var txtUrlLabel=new qx.ui.basic.Atom('URL');txtUrlLabel.setHorizontalChildrenAlign('right');txtUrlLabel.set({top:85,left:30,width:'10%'});var txtURL=new qx.ui.form.TextField();txtURL.set({top:85,right:30,width:'70%',value:'http://'});var txtTip2="The URL to launch when the button is clicked.";var tipIcon2=new qx.ui.basic.Atom("","icon/16/apps/accessories-tip.png");tipIcon2.set({top:85,right:10});var tooltipBtn=new qx.ui.basic.Atom(txtTip2);var tt2=new qx.ui.popup.ToolTip(txtTip2);tipIcon2.setToolTip(tt2);var btnOK=new qx.ui.form.Button("OK","icon/16/actions/dialog-ok.png");var btnCancel=new qx.ui.form.Button("Cancel","icon/16/actions/dialog-cancel.png");btnOK.set({bottom:10,right:10});btnCancel.set({bottom:10,right:60});btnOK.addEventListener("execute",function(e){this.setBtnName(txtName.getValue());this.setBtnUrl(txtURL.getValue());if(!txtName.getValue().length||!txtURL.getValue().length)this.getWireFrame()._showAlertDialog("error","Please enter both a name and URL for the new toolbar button.","Toolbar Error",null);else this.__installButton(txtName.getValue(),txtURL.getValue());},this);btnCancel.addEventListener("execute",function(e){this.getNewButtonWin().close();},this);this.getNewButtonWin().add(at1,txtUrlLabel,txtURL,tipIcon,txtNameLabel,txtName,tipIcon2,btnOK,btnCancel);this.getNewButtonWin().open();},__installButton:function(name,url){var callback=new qx.lang.Function.bind(this.__installButtonHandler,this);this.getWireFrame()._callAsyncRpc(callback,"core.rpc.api.Preferences","insert",this.getWireFrame().getUserAttribs()['dn'],name,url,"toolbarButton");},__installButtonHandler:function(result,ex,id){if(ex!=null){this.getWireFrame()._showAlertDialog("error",ex.toString(),"RPC Error",null);return false;}if(result){this.getLd().push({Name:{text:this.getBtnName()},Url:{text:this.getBtnUrl()}});this.getLv().updateSort();this.getLv().update();this.getWireFrame()._setToolbarButton(this.getBtnName(),this.getBtnUrl());this.getNewButtonWin().close();}},close:function(){this.base(arguments);},terminate:function(){this.base(arguments);}}});
