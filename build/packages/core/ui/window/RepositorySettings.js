if(!window.qxsettings)qxsettings={};if(qxsettings["qx.version"]==undefined)qxsettings["qx.version"]="0.0";if(qxsettings["qx.isSource"]==undefined)qxsettings["qx.isSource"]=false;if(!window.qxvariants)qxvariants={};qx.Class.define("packages.core.ui.window.RepositorySettings",{extend:vhf.Main,properties:{Parent:{init:vhf.Main.getInstance()},RepoSettingsWin:{init:new qx.ui.window.Window("Repository Settings","icon/16/devices/drive-optical.png")},RepoOuDn:{init:new qx.ui.form.TextField()},UpdateBtn:{init:new qx.ui.form.Button("Apply","icon/16/actions/dialog-apply.png")}},construct:function(){this.main();},members:{main:function(){this.getRepoSettingsWin().set({showMinimize:true,allowMinimize:false,allowMaximize:true});this.getRepoSettingsWin().setSpace(225,400,100,200);this.getRepoSettingsWin().setShowStatusbar(true);this.getParent()._addToWorkspace(this.getRepoSettingsWin());var at1=new qx.ui.basic.Atom("Enter the distinguished name of the organizational unit<br>where you would like to store the repository objects.","icon/22/devices/drive-optical.png");at1.setLocation(4,4);var lblRepoDn=new qx.ui.basic.Atom("Repository OU DN");lblRepoDn.setHorizontalChildrenAlign("right");lblRepoDn.set({top:60,left:10});this.getRepoOuDn().set({top:60,right:30,width:'50%'});this.getRepoOuDn().addEventListener("input",function(e){this.getUpdateBtn().setEnabled(true);},this);var txtTip1="The distinguished name of the organizational unit to store repository objects<br><b>Example: </b>cn=Admins,ou=Groups,ou=Administration,dc=vhf,dc=local";var tipIco1=new qx.ui.basic.Atom("","icon/16/apps/accessories-tip.png");tipIco1.set({top:60,right:10});var tooltipBtn1=new qx.ui.basic.Atom(txtTip1);var tt1=new qx.ui.popup.ToolTip(txtTip1);tipIco1.setToolTip(tt1);this.getUpdateBtn().set({bottom:10,right:10});this.getUpdateBtn().addEventListener("execute",function(e){this.__updateConfigs(this.getRepoOuDn().getValue());},this);this.getRepoSettingsWin().add(at1);this.getRepoSettingsWin().add(lblRepoDn,this.getRepoOuDn(),tipIco1);this.getRepoSettingsWin().add(this.getUpdateBtn());this.getRepoSettingsWin().open();this.__getConfigs();},__updateConfigs:function(ouDn){this.getRepoSettingsWin().setStatus("Updating configuration "+name+"...");var callback=qx.lang.Function.bind(this.__updateConfigsHandler,this);this.getParent()._callAsyncRpc(callback,"core.rpc.ui.Settings","updateRepositoryConfigs",ouDn);},__updateConfigsHandler:function(result,ex,id){if(ex!=null){this.getRepoSettingsWin().setStatus("Ready");this.getParent()._showAlertDialog("error",ex.toString(),"RPC Failure",null);return;}if(result){this.getRepoSettingsWin().setStatus("Ready");this.getUpdateBtn().setEnabled(false);this.getRepoSettingsWin().close();}},__getConfigs:function(){var callback=qx.lang.Function.bind(this.__getConfigsHandler,this);this.getParent()._callAsyncRpc(callback,"core.rpc.ui.Settings","getRepositoryConfigs",null);},__getConfigsHandler:function(result,ex,id){if(ex!=null){this.getParent()._showAlertDialog("error",ex.toString(),"RPC Failure",null);return;}if(result){for(var i=0;i<result.length;i++){switch(result[i].name){case "REPOSITORY_OU_DN":this.getRepoOuDn().setValue(result[i].value);break;}}}this.getUpdateBtn().setEnabled(false);},close:function(){this.base(arguments);},terminate:function(){this.base(arguments);}}});
